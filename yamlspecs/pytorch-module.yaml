# bild the module for pytorch
!include pytorch.yaml
!include rcic-module.yaml
---
- package: pytorch module
  pkgname: "{{basename}}{{suffix}}_{{version}}_python{{python_version}}-module"
  category: AI-LEARNING
  module:
    path: "{{pkg_defaults.RCICmpath}}/{{category}}/{{basename}}"
    prepend_path:
      - PATH "{{pkg_defaults.app_path}}/python/{{python_version}}/bin"
    prereq:
      - "{{module.base_prereq}}"
    base_prereq:
      - python/{{python_version}}
      - gcc/{{versions.gcc}}
      - mkl/{{versions.mkl}}
      - ffmpeg/{{versions.ffmpeg}}
      - fftw/{{versions.fftw}}
  requires:
    - "{{base_requires}}"
  base_requires:
    - "{{basename}}{{suffix}}_{{version}}_python{{python_version}}"
    - python_{{python_version}}-module
    - gcc_{{versions.gcc}}-module
    - mkl_{{versions.mkl}}-module
    - ffmpeg_{{versions.ffmpeg}}-module
    - fftw_{{versions.fftw}}-module
    - rcic-module-support
  conflicts: "{{basename}}-cuda_{{version}}_python{{python_version}}-module"
